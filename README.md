# **OFFLINE YouTube Video Search Application**

This application allows users to **extract transcripts from YouTube videos**, **create searchable vector databases**, and **perform semantic searches** using a **Gradio web interface** or **command-line interface (CLI)**. It's powered by `faster-whisper` for transcription, `FAISS` for vector search, and `sentence-transformers` for text embeddings.

---

## **Features**
- Extract transcripts from individual videos and playlists.
- Automatically detect playlists and individual video links.
- Automatically download video thumbnails.
- Store transcripts and create a searchable vector database.
- Perform semantic searches on video content.
- Supports **Gradio web interface** and **CLI** for flexible usage.
- Easily add more videos to the dataset.

---

## **Web Interface**
<img width="520" alt="image" src="https://github.com/user-attachments/assets/81c20089-f786-4743-a151-307560acbe1a">
<img width="526" alt="image" src="https://github.com/user-attachments/assets/a7e8fe0b-d6d7-436d-ab44-857f143035c3">

---

## **Installation**

Ensure you have Python installed (>= 3.7). Then, install the required dependencies:

```bash
pip install -r requirements.txt
```

---

## **Usage**

The app provides **two ways to interact**:  
1. **Gradio Web Interface**  
2. **Command-Line Interface (CLI)**

### **1. Running the Gradio Web Interface**

Launch the web interface:

```bash
python app.py ui
```

or simply:

```bash
python app.py
```

Then, open the URL (usually `http://127.0.0.1:7860`) in your browser.

#### **Gradio Interface Tabs:**

- **Add Videos:**  
  - Enter playlist URLs and/or individual video URLs (comma-separated).
  - The app will automatically detect whether each link is a playlist or a video.
  - Videos will be transcribed, and the database will be updated with the content.
  
- **Search:**  
  - Enter search queries to find relevant snippets from the video transcripts.
  - Results are ranked based on semantic similarity and include video thumbnails.

---

### **2. Command-Line Interface (CLI)**

The CLI provides more flexibility for programmatic use.

#### **Commands Overview**

Use the `--help` command to view available commands and examples:

```bash
python app.py --help
```

**Output:**

```
usage: app.py [-h] {add,search,ui} ...

YouTube Video Search Application

positional arguments:
  {add,search,ui}   Available commands
    add             Add videos to the database
    search          Search the video database
    ui              Launch the Gradio web interface

optional arguments:
  -h, --help        Show this help message and exit

Examples:
  # Add videos from playlists and individual links
  python app.py add --input "https://www.youtube.com/playlist?list=YOUR_PLAYLIST_ID,https://www.youtube.com/watch?v=VIDEO_ID"

  # Add specific videos without keeping videos locally
  python app.py add --input "https://www.youtube.com/watch?v=VIDEO_ID1,https://www.youtube.com/watch?v=VIDEO_ID2"

  # Search the database with a query
  python app.py search --query "Your search query" --top_k 5

  # Run the Gradio web interface
  python app.py ui
```

---

### **Examples of CLI Usage**

#### **1. Adding Videos**

- **Add Playlists and Videos:**

   ```bash
   python app.py add --input "https://www.youtube.com/playlist?list=YOUR_PLAYLIST_ID,https://www.youtube.com/watch?v=VIDEO_ID"
   ```

- **Add Specific Videos Without Keeping Them Locally:**

   ```bash
   python app.py add --input "https://www.youtube.com/watch?v=dQw4w9WgXcQ,https://www.youtube.com/watch?v=9bZkp7q19f0" --keep_videos False
   ```

#### **2. Searching the Database**

- **Perform a Search:**

   ```bash
   python app.py search --query "machine learning tutorials" --top_k 5
   ```

---

### **How It Works**

1. **Adding Videos:**
   - The app accepts a list of links and automatically detects whether each link is a playlist or an individual video.
   - It downloads video audio and transcribes it using `faster-whisper`.
   - Thumbnails are downloaded and saved locally.
   - The transcript data is saved in `datasets/transcript_dataset.csv`.
   - A vector database is updated using FAISS with embeddings generated by `sentence-transformers`.

2. **Incremental Updating:**
   - Videos are processed one by one, and the dataset and vector database are updated incrementally.
   - This ensures efficient processing, especially when dealing with large datasets.

3. **Searching the Database:**
   - When a query is entered, the app computes its embedding and searches the FAISS index for relevant video snippets.
   - The top results are displayed with thumbnails, titles, and links to the videos.

---

### **FAQ**

#### **1. How do I add multiple playlists and videos at once?**

Simply provide a comma-separated list of URLs, and the app will automatically detect and process each link:

```bash
python app.py add --input "https://www.youtube.com/playlist?list=PLAYLIST_ID1,https://www.youtube.com/watch?v=VIDEO_ID,https://www.youtube.com/playlist?list=PLAYLIST_ID2"
```

#### **2. Why aren’t new videos showing up in search results?**

Ensure that the videos have been fully processed and that the vector database has been updated. The app handles this automatically, but processing may take time for large videos or playlists.

#### **3. How do I prevent videos from being stored locally?**

By default, the app keeps videos stored locally. To change this behavior, use the `--keep_videos` flag and set it to `False`:

```bash
python app.py add --input "VIDEO_OR_PLAYLIST_URL" --keep_videos False
```

#### **4. Can I search the database without launching the Gradio interface?**

Yes! Use the `search` command via the CLI:

```bash
python app.py search --query "Your query" --top_k 5
```

---

### **Project Structure**

```
.
├── app.py                       # Main application script (Gradio + CLI)
├── lib/
│   └── functions.py             # Helper functions for transcription, FAISS, etc.
├── datasets/
│   ├── transcript_dataset.csv   # CSV file storing transcripts
│   └── vector_index.faiss       # FAISS vector index
├── thumbnails/                  # Folder for storing video thumbnails
├── videos/                      # Folder for storing downloaded videos (if keep_videos is True)
├── tmp/                         # Temporary folder for videos (if keep_videos is False)
```

---

### **Known Limitations**

- **Processing Time:** Transcribing videos and generating embeddings can be time-consuming, especially for long videos or large playlists.
- **Storage Requirements:** Keeping videos stored locally will require additional disk space. Use the `--keep_videos False` option if storage is a concern.
- **Large Datasets:** As the dataset grows, querying may take longer. Consider optimizing the FAISS index for very large datasets.

---

### **Contributing**

Feel free to fork the repository, open issues, or submit pull requests if you'd like to contribute to this project.

---

### **License**

This project is licensed under the MIT License. See the LICENSE file for details.

---

### **Acknowledgments**

- **faster-whisper** for fast transcription.
- **FAISS** for efficient vector search.
- **Gradio** for the interactive web interface.
- **yt-dlp** for downloading video content.
